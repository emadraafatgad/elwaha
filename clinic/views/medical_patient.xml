<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="patient_identification_code" model="ir.sequence">
        <field name="name">identification_code</field>
        <field name="code">oeh.medical.patient</field>
        <field name="prefix">PID</field>
        <field name="padding">5</field>
        <field name="company_id" eval="False"/>
    </record>

    <record id="oeh_medical_patient_action_tree" model="ir.actions.act_window">
        <field name="name">Patients</field>
        <field name="res_model">oeh.medical.patient</field>
        <field name="view_type">form</field>
        <field name="view_mode">kanban,tree,form,search</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>


    <record model="ir.ui.view" id="oeh_medical_patient_view_id">
        <field name="name">Patient profile</field>
        <field name="model">oeh.medical.patient</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
            <form string="Patient">
                <sheet>
                    <div class="oe_button_box" name="buttons">
                        <button type="action" class="oe_stat_button" name="%(oeh_medical_appointment_action_tree)d"
                                context="{'search_default_patient': active_id,'default_patient': active_id}"
                                icon="fa-calendar">
                            <field string="Appointments" name="app_count" widget="statinfo"/>
                        </button>
                        <button type="action" class="oe_stat_button" name="%(account.action_invoice_tree1)d"
                                context="{'search_default_patient': active_id,'default_patient': active_id}"
                                icon="fa-pencil-square-o">
                            <field string="Invoices" name="invoice_count" widget="statinfo"/>
                        </button>
                        <button type="action" class="oe_stat_button" name="%(clinic.oeh_medical_service_action_tree)d"
                                context="{'search_default_patient_id': active_id,'default_patient': active_id}"
                                icon="fa-list">
                            <field string="Sessions" name="service_count" widget="statinfo"/>
                        </button>
                    </div>
                    <div>
                        <field name="image" widget='image' class="oe_left oe_avatar"
                               options='{"preview_image": "image_medium", "size": [90, 90]}'/>
                        <div class="oe_title">
                            <h1>
                                <field name="name" required="1"/>
                            </h1>
                            <h3>
                                <field name="identification_code"/>
                            </h3>
                        </div>
                    </div>
                    <group>
                        <group col="2">
                            <field name="age"/>
                            <field name="sex"/>
                            <field name="phone"/>
                            <field name="email"/>
                        </group>
                        <group col="2">
                            <field name="address"/>
                            <field name="country_id"/>
                            <field name="occupation"/>
                            <field name="ssn"/>
                        </group>
                        <group col="4" string="How do Reach Us">
                            <field name="Social"/>
                            <field name="Friend"/>
                            <field name="T_V"/>
                            <field name="Outdoor"/>
                            <field name="Visita"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="General info">
                            <group>
                                <field name="general_info"/>
                            </group>
                        </page>
                        <page string="Appointments">
                            <field name="appointment_id" readonly="True"/>
                        </page>
                        <page string="Sessions">
                            <field name="service_ids"/>
                        </page>
                        <page string="Evaluations">
                            <field name="evaluation_ids"/>
                        </page>
                        <page string="Prescription">
                            <field name="prescription_ids"/>
                        </page>
                        <page string="Evaluation">
                            <field name="evaluation_name_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="oeh_medical_patient_kanban_view">
        <field name="name">Patient Kanban</field>
        <field name="model">oeh.medical.patient</field>
        <field name="arch" type="xml">
            <kanban>
                <field name="id"/>
                <field name="name"/>
                <field name="sex"/>
                <field name="age"/>
                <field name="phone"/>
                <field name="country_id"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_global_click o_kanban_record_has_image_fill o_hr_kanban_record">
                            <div class="o_kanban_image_fill_left d-none d-md-block"
                                 t-attf-style="background-image: url(#{kanban_image('oeh.medical.patient', 'image_medium', record.id.raw_value)})"
                                 role="img"/>

                            <div class="oe_kanban_details">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <field name="name"/>
                                        </strong>
                                    </div>
                                </div>
                                <div t-if="record.age.value">
                                    <t t-esc="record.age.value"/>
                                </div>
                                <div t-if="record.sex.value">
                                    <t t-esc="record.sex.value"/>
                                </div>
                                <div t-if="record.country_id.raw_value">
                                    <t t-esc="record.country_id.raw_value"/>
                                </div>
                                <div t-if="record.phone.value">
                                    <t t-esc="record.phone.value"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>

        </field>
    </record>


    <record model="ir.ui.view" id="oeh_medical_patient_tree">
        <field name="name">Patient List</field>
        <field name="model">oeh.medical.patient</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree string='Patient Information'>
                <field name="name"></field>
                <field name="identification_code"/>
                <field name="sex"></field>
                <field name="age"></field>
            </tree>
        </field>
    </record>


    <record id="view_oeh_medical_patient_filter" model="ir.ui.view">
        <field name="name">oeh.medical.patient.select</field>
        <field name="model">oeh.medical.patient</field>
        <field name="type">search</field>
        <field name="arch" type="xml">
            <search string="Search Patients">
                <separator orientation="vertical"/>
                <field name="name" select="1"/>
                <field name="ssn" string="national ID" select="1"/>
                <field name="identification_code" string="code" select="1"/>
                <field name="phone"/>
                <newline/>
            </search>
        </field>
    </record>

    <menuitem id="medical_patient_root"
              name="Patient"
              parent="medical_root"
              sequence="30"
    />

    <menuitem id="medical_patient"
              name="Patient"
              parent="medical_patient_root"
              sequence="10"
              action="clinic.oeh_medical_patient_action_tree"
    />

</odoo>